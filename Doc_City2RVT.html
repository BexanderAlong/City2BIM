<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Doc_City2RVT.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}@import url(http://fonts.googleapis.com/css?family=Roboto+Condensed:300italic,400italic,700italic,400,300,700);.haroopad{padding:20px;color:#222;font-size:15px;font-family:"Roboto Condensed",Tauri,"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;background:#fff;line-height:1.6;-webkit-font-smoothing:antialiased}.haroopad a{color:#3269a0}.haroopad a:hover{color:#4183c4}.haroopad h2{border-bottom:1px solid #e6e6e6}.haroopad h6{color:#777}.haroopad hr{border:1px solid #e6e6e6}.haroopad blockquote>code,.haroopad h1>code,.haroopad h2>code,.haroopad h3>code,.haroopad h4>code,.haroopad h5>code,.haroopad h6>code,.haroopad li>code,.haroopad p>code,.haroopad td>code{font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;font-size:85%;background-color:rgba(0,0,0,.02);padding:.2em .5em;border:1px solid #efefef}.haroopad pre>code{font-size:1em;letter-spacing:-1px;font-weight:700}.haroopad blockquote{border-left:4px solid #e6e6e6;padding:0 15px;color:#777}.haroopad table{background-color:#fafafa}.haroopad table tr td,.haroopad table tr th{border:1px solid #e6e6e6}.haroopad table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;overflow-x:auto;padding:.5em;background:#fdf6e3;color:#657b83;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment,.hljs-doctype,.hljs-javadoc,.hljs-pi,.lisp .hljs-string{color:#93a1a1}.css .hljs-tag,.hljs-addition,.hljs-keyword,.hljs-request,.hljs-status,.hljs-winutils,.method,.nginx .hljs-title{color:#859900}.hljs-command,.hljs-dartdoc,.hljs-hexcolor,.hljs-link_url,.hljs-number,.hljs-phpdoc,.hljs-regexp,.hljs-rules .hljs-value,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#2aa198}.css .hljs-function,.hljs-built_in,.hljs-chunk,.hljs-decorator,.hljs-id,.hljs-identifier,.hljs-localvars,.hljs-title,.vhdl .hljs-literal{color:#268bd2}.hljs-attribute,.hljs-class .hljs-title,.hljs-constant,.hljs-link_reference,.hljs-parent,.hljs-type,.hljs-variable,.lisp .hljs-body,.smalltalk .hljs-number{color:#b58900}.css .hljs-pseudo,.diff .hljs-change,.hljs-attr_selector,.hljs-cdata,.hljs-header,.hljs-pragma,.hljs-preprocessor,.hljs-preprocessor .hljs-keyword,.hljs-shebang,.hljs-special,.hljs-subst,.hljs-symbol,.hljs-symbol .hljs-string{color:#cb4b16}.hljs-deletion,.hljs-important{color:#dc322f}.hljs-link_label{color:#6c71c4}.tex .hljs-formula{background:#eee8d5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:2px;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:2px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:1em}.MathJax_MenuRadioCheck.RTL{right:1em;left:auto}.MathJax_MenuLabel{padding:2px 2em 4px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #CCC;margin:4px 1px 0}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:Highlight;color:HighlightText}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown haroopad">
<h1 id="city2rvt---plugin-zum-import-von-amtlichen-geodaten"><a name="city2rvt---plugin-zum-import-von-amtlichen-geodaten" href="#city2rvt---plugin-zum-import-von-amtlichen-geodaten"></a>City2RVT - Plugin zum Import von amtlichen Geodaten</h1><hr class="section"><p><ins><strong><a href="#overview">-&gt; short english version</a></strong>
</ins></p><h2 id="überblick"><a name="überblick" href="#überblick"></a>Überblick</h2><p><img src="pic/3d_overview.png" alt="Overview"></p><p><strong>Plugin für Autodesk Revit</strong> zur Georeferenzierung und Verknüpfung von Geodaten in Revit.<br>Unterstützt wird:</p><ul>
<li>Georeferenzierung von BIM-Projekten, u.a. Berechnung von WGS84 nach UTM-Landeskoordinaten (amtliche Systeme in Deutschland)</li><li>Import von Stadtmodellen per Serveranfrage oder dateibasiert</li><li>Import von ALKIS (amtliches Liegenschaftskataster in Deutschland)</li><li>Import von Raster-DGM</li></ul><h2 id="installation"><a name="installation" href="#installation"></a>Installation</h2><p>Nach dem Download führen Sie die im Ordner befindliche Setup.exe aus. Das Plugin sollte automatisch installiert werden.</p><p>Bei nächsten Start von Autodesk Revit 2019 sollte das Plugin vorhanden sein. Falls beim Öffnen gefragt wird, ob das Plugin geladen werden soll, bestätigen Sie dies bitte mit <em>Immer laden</em>.</p><p>Sollte das Plugin nicht vorhanden sein, befindet sich Ihre Revit-Installation eventuell nicht im vom Setup angenommenen Ordner <em>[CommonAppDataFolder]\Autodesk\Revit\Addins\2019</em>.<br>Der CommonAppDataFolder ist meistens <em>C:\ProgramData</em>.</p><p>In diesem Fall muss manuell zum Addins-Ordner navigiert werden und dort die Datei <em>City2BIM.addin</em> sowie der Ordner <em>City2RVT</em> abgelegt werden.</p><h3 id="entwicklungsumgebung"><a name="entwicklungsumgebung" href="#entwicklungsumgebung"></a>Entwicklungsumgebung</h3><p>Das Plugin wurde mit Microsoft Visual Studio 2019 im .NET Framework in C# entwickelt.<br>Tests in Revit wurden größtenteils in der Version 2019 durchgeführt.</p><h3 id="abhängigkeiten"><a name="abhängigkeiten" href="#abhängigkeiten"></a>Abhängigkeiten</h3><p>Für die Programmierung wurden folgende freie API genutzt: </p><ul>
<li><a href="https://github.com/dd-bim/City2BIM">City2BIM</a> zum Lesen der CityGml und ALKIS-Daten (im Projekt entwickelt)</li><li><a href="https://www.nayuki.io/page/convex-hull-algorithm">Project Nayuki</a> zur Berechnung konvexer Hüllen</li><li><a href="https://geographiclib.sourceforge.io/">GeograpicLib</a> zur Umrechnung von WGS84 (Breite/Länge) - Koordinaten in die deutschen UTM-Landessysteme der Zonen 32 und 33, Berechnung projektspezifischen Maßstabes, Berechnung Gitter-Nord </li><li><a href="https://serilog.net/">Serilog</a> zum Protokollieren von Log-Nachrichten</li><li><a href="https://www.revitapidocs.com/">Revit API</a> zum Import nach Revit (proprietär, nicht in Download enthalten)</li></ul><p>Vielen Dank an die Entwickler an dieser Stelle!</p><h3 id="beteiligte-/-kontakt-/-lizenz"><a name="beteiligte-/-kontakt-/-lizenz" href="#beteiligte-/-kontakt-/-lizenz"></a>Beteiligte / Kontakt / Lizenz</h3><p><a href="#contributors">-&gt; siehe hier</a></p><h2 id="plugin-oberfläche"><a name="plugin-oberfläche" href="#plugin-oberfläche"></a>Plugin-Oberfläche</h2><p>Die Funktionalitäten des Plugins sind erreichbar in der Multifunktionsleiste unterhalb des Registerkarteneintrages “City2BIM”.</p><p><img src="pic/ribbon_entry.png" alt="Registerkarte"></p><p>Sollte dieser Eintrag nicht vorhanden sein, muss geprüft werden, ob die .addin-Datei* an der richtigen Stelle liegt bzw. ob der Link in der editierbaren .addin-Datei richtig gesetzt ist (<a href="#installation">siehe Installation</a>).</p><p>Die Ribbonleiste des Plugins enthält folgende Icons, dessen Funktionen im Folgenden erläutert werden:</p><p><img src="pic/ribbon.png" alt="Ribbon-Leiste"></p><h2 id="empfohlener-programmablauf"><a name="empfohlener-programmablauf" href="#empfohlener-programmablauf"></a>Empfohlener Programmablauf</h2><p>Im Folgenden soll kurz beschrieben werden, wie das Plugin bestmöglich genutzt werden kann.</p><p>Vorbereitung:</p><ul>
<li>Beschaffung von relevanten Geodaten:<br>— Stadtmodell-Daten im CityGML-Format (entfällt, wenn Daten von VCS-Server ausreichen)<br>— ALKIS-Daten im NAS-XML-Format<br>— Geländedaten als Raster-DGM (Gitterweite je nach gewünschter Genauigkeit/Realitätstreue)</li><li>Festlegung der Projektbasispunkt-Koordinate:<br>— bestenfalls in metrischen Landessystem-Koordinaten<br>— alternativ: WGS84-Koordinate mit Breite/Länge ausreichend (wenn als geodätisches System ein ETRS89_UTM verwendet wird)</li></ul><p>Programmablauf:</p><ul>
<li>Wichtig ist zunächst die <strong>Festlegung der Georeferenzierung</strong> duch Übergabe der Projektbasispunktkoordinate in Lage und Höhe</li><li>anschließend können relevante Geodaten importiert werden<br>— Achtung: es ist darauf zu achten, dass sämtliche Geodaten im selben Bezugssystem vorliegen</li><li>sollen ein oder mehrere ALKIS-Themen auf dem Gelände drapiert werden, muss <strong>vor</strong> dem ALKIS-Import das Gelände importiert werden</li></ul><h2 id="georeferenzierung"><a name="georeferenzierung" href="#georeferenzierung"></a>Georeferenzierung</h2><p><img src="pic/georef.png" alt="Icon_georef"></p><p>Mithilfe der Funktionen zur Georeferenzierung wird dem Revit-Projekt eine übergeordnete (oder auch lokale) Referenzierung übergeben.<br>Die einzeln einzustellenden Werte haben Einfluss auf verschiedene Revit-Parameter, die im Folgenden näher erläutert werden.</p><p>Weiterführende Informationen zur Georeferenzierung in BIM und im Speziellen in IFC (Level of Georeferencing) erhalten Sie <strong><a href="https://github.com/dd-bim/IfcGeoRef/blob/master/Documentation_v3.md">hier (Link zu Github)</a></strong>.<br>Dort ist auch ein Tool zur Überprüfung/Änderung der Georeferenzierung in IFC-Dateien verfügbar.</p><p><img src="pic/georef_settings.png" alt="Icon_georef"></p><h3 id="adresseingaben-(postal-address,-derzeit-nicht-berücksichtigt)"><a name="adresseingaben-(postal-address,-derzeit-nicht-berücksichtigt)" href="#adresseingaben-(postal-address,-derzeit-nicht-berücksichtigt)"></a>Adresseingaben (Postal Address, derzeit nicht berücksichtigt)</h3><p>Derzeit ist eine Revit-interne Speicherung leider noch nicht implementiert, da Autodesk zwischen den Versionen der letzten Jahre Adressen unterschiedlich berücksichtigt. Es ist geplant in folgenden Versionen eine Speicherung der Daten Revit-intern in äquivalenten Parametern zu ermöglichen.</p><h3 id="baustellenkoordinate-in-breite/länge-(geographic-site-coordinates)"><a name="baustellenkoordinate-in-breite/länge-(geographic-site-coordinates)" href="#baustellenkoordinate-in-breite/länge-(geographic-site-coordinates)"></a>Baustellenkoordinate in Breite/Länge (Geographic site coordinates)</h3><p>Einfache Übergabe einer Punktreferenzierung in WGS84 im Format Breite/Länge zur groben Georeferenzierung.<br>Die Eingabe der Werte ändert den revit-internen Standort des Projektes, welcher auch folgendermaßen abrufbar ist:<br><em>Verwalten -&gt; Projektposition-Standort -&gt; Reiter Standort</em></p><p>Die eigegebenen Werte werden dort übernommen, siehe Bild:</p><p><img src="pic/georef_site.png" alt="Icon_georef"></p><p>Außerdem wird die Rotation (“True North”) im Projektbasispunkt angepasst für das Revit-XY-Koordinatensystem übernommen.</p><p>Falls das Projekt nach IFC exportiert werden soll, wird diese Koordinate in das “IfcSite”-Objekt in die Attribute “RefLatitude” und “RefLongitude” geschrieben.</p><p>Die Koordinate ist die Entsprechung des Revit-Projektbasispunktes in WGS84. Sie dient außerdem beim serverbasierten Import von Stadtmodell-Daten als Referenz, von welchem Gebiet Stadtmodell-Daten abgerufen werden sollen.</p><h3 id="landeskoordinaten-(projected-coordinates)"><a name="landeskoordinaten-(projected-coordinates)" href="#landeskoordinaten-(projected-coordinates)"></a>Landeskoordinaten (Projected coordinates)</h3><p>Möglichkeit zur Übergabe von geodätischen (oder auch lokalen) Koordinaten für den Import von Geodaten bzw. die Speicherung einer Georeferenzierung in einem geodätischen Koordinatenreferenzsystem.<br>Die Eingabe/Berechnung der Werte hat folgenden Einfluss innerhalb des Revit-Projektes:</p><ul>
<li>Setzen des Projektbasispunktes (Eastings, Northings)</li><li>Speicherung der Koordinaten sowie der Daten zu Rotation, Maßstab und EPSG-Code als Projektparameter</li><li>Berücksichtigung des Maßstabes beim Import von Geodaten über das Plugin (der Maßstab wird “herausgerechnet”, in Revit ist der Maßstab intern immer  gleich 1.000000)</li></ul><p>Projektbasispunkt-Koordinaten, Übernahme von:</p><ul>
<li>Eastings</li><li>Northings</li><li>Orthometric Height</li><li>True North (angepasst an Revit-XY)</li></ul><p><img src="pic/pbp.png" alt="Projektbasispunkt"></p><h3 id="höhenangaben-(elevation)"><a name="höhenangaben-(elevation)" href="#höhenangaben-(elevation)"></a>Höhenangaben (Elevation)</h3><p>Möglichkeit zur Eingabe einer Projekthöhe sowie eines Höhenbezugssystems.<br>Die Eingabe/Berechnung der Werte hat folgenden Einfluss innerhalb des Revit-Projektes:</p><ul>
<li>Setzen der Projekthöhe im Projektbasispunkt</li><li>Speicherung der Projekthöhe, des Bezugssystems als Projektparameter</li></ul><p>Speicherung als Projektparameter, <em>Verwalten —&gt; Einstellungen-Projektinformationen</em>:</p><p><img src="pic/Projektinformationen.png" alt="Projektinformationen"></p><p>Die Parameter werden durch das Plugin angelegt und orientieren sich daran, wie eine Georeferenzierung nach IFC übergeben werden soll. Wird später die derzeit implementierte IFC-Export Option benutzt, kann die Georeferenzierung standardkonform als IFC-PropertySet mit dem revit-eigenen IFC Exporter übergeben werden.</p><p>Die Daten sollten an dieser Stelle nicht manuell geändert werden. Die gespeicherten Werte für die Rotation in <em>XAxisAbscissa</em> und <em>XAxisOrdinate</em> beziehen sich hierbei in Vektorschreibweise umgerechneten Winkel aus Grid North. (Zu beachten ist der Unterschied zwischen True North und Grid North bspw. für Sonnenstandsanalysen).</p><h3 id="wgs84-utm---berechnung"><a name="wgs84-utm---berechnung" href="#wgs84-utm---berechnung"></a>WGS84-UTM - Berechnung</h3><p><img src="pic/georef_calc.png" alt="UTM_berechnung"></p><p>Zusätzlich zu den Eingabemöglichkeiten bietet das Plugin die Möglichkeit aus WGS84 Landeskoordinaten zu berechnen. Dies ist z.B. hilfreich, falls (noch) keine Koordinaten im Landessystem bekannt sind. Die Berechnung ist ach in umgekehrter Reihenfolge (siehe Bild) möglich.<br>Folgende Parameter werden berechnet:</p><ul>
<li>Eastings, Northings aus Latitude, Longitude bzw. umgekehrt</li><li>Grid North aus True North (sowie Longtude) bzw. umgekehrt (Berücksichtigung der Meridiankonvergenz)</li><li>Scale, Maßstabsberechnung, abhängig von Meridian (Longitude bzw. Eastings) und Projekthöhe (Orthometric Height)</li></ul><p>Voraussetzung:</p><ul>
<li>Wahl eines vordefinierten EPSG-Codes (entsprechen den ETRS89_UTM-Landessystemen in Zone 32 oder 33 in Deutschland)</li></ul><h2 id="import-von-stadtmodellen-(city2bim)"><a name="import-von-stadtmodellen-(city2bim)" href="#import-von-stadtmodellen-(city2bim)"></a>Import von Stadtmodellen (City2BIM)</h2><p><img src="pic/city2bim.png" alt="Icon_City2BIM"></p><p>Die City2BIM-Funktion bietet die Möglichkeit, Gebäude aus CityGml-Dateien zu importieren. In Deutschland (u.a. Ländern) werden 3D-Modelle amtlich im CityGml-Format (OGC-Standard) vorgehalten. Das Plugin bietet die Möglichkeit, Gebäude aus diesen Dateien nach Revit zu importieren.</p><p>Es werden die äußeren Begrenzungsflächen eines Gebäudes in LOD1- oder LOD2-Ausprägung (je nach Verfügbarkeit) entweder als geschlossene “wasserdichte” Volumenkörper (<em>…as Solids</em>) oder als Flächenmodelle (<em>…as Surfaces</em>) importiert.<br>LOD2-Daten zeichnen sich durch die Berücksichtigung der Dachform aus und sind somit z.B. für Solarpotentialanalysen wichtig.<br>LOD1-Daten enthalten lediglich einen in die Höhe (meist Gebäudehöhe am First) extrudierten Grundriss des Gebäudes.</p><p>Bevor Daten importiert werden können, wird empfohlen, die Settings anzupassen:</p><h3 id="settings"><a name="settings" href="#settings"></a>Settings</h3><p><img src="pic/city2bim_settings.png" alt="Icon_City2BIM"></p><p>In den Settings werden die Parameter zum Import vorgehalten:</p><ul>
<li>Datenquelle (<em>Source</em>): von Sever oder lokaler Datei</li><li>Einstellungen zur Serverabfrage</li><li>Einstellungen zum Dateiimport</li><li>Übersetzung von Codierungen in der CityGML</li></ul><h4 id="server-abfrage-(server-settings)"><a name="server-abfrage-(server-settings)" href="#server-abfrage-(server-settings)"></a>Server-Abfrage (Server settings)</h4><p>Über diese Möglichkeit können direkt CityGML-Daten per Server-Anfrage vom Projektpartner <em>virtualcitysystems</em> abgerufen werden.<br>Technisch wird dies über eine WFS (Web Feature Service)-Anfrage realisiert.<br>Informationen zu diesem WFS erhalten Sie <a href="https://hosting.virtualcitywfs.de/deutschland_viewer/wfs?Request=GetCapabilities&amp;Service=WFS">hier (GetCapabilities XML-Dokument)</a>.</p><p>Die WFS-Abfrage benötigt folgende Parameter:</p><ul>
<li>URL des WFS (bereits hinterlegt, bei späteren Änderungen über <em>Edit URL</em> editierbar)</li><li>Mittelpunkt des gewünschten Bereiches (als Standard ist Koordinate von Georeferenzierung gesetzt, kann über <em>custom</em> geändert werden)</li><li>Ausdehnung des gewünschten Gebietes in Meter</li></ul><p>Auf Wunsch kann die vom Server intern zurückgegebene CityGML-Datei auch lokal im CityGML-Format gespeichert werden. Dazu muss lediglich der Haken bei <em>save response to</em> gesetzt und im <em>…</em>-Button ein Speicherziel ausgewählt werden.</p><p>Ein Beispiel für eine Server-Antwort (Center: 51.659987, 6.964985 / Extent: 300 m):</p><p><img src="pic/city2bim_server.png" alt="Icon_City2BIM"></p><h5 id="einschränkungen"><a name="einschränkungen" href="#einschränkungen"></a>Einschränkungen</h5><ul>
<li>Server-Abfragen funktionieren nur auf dem Gebeit der Bundesrepublik Deutschland!</li><li>Die Daten werden je nach Einstellung im deutschen amtlichen System <strong>ETRS89_UTM32 (EPSG:25832)</strong> oder <strong>ETRS89_UTM33 (EPSG:25833)</strong> zurückgegeben</li><li>Die Qualität der Daten hängt vom jeweiligen Bundesland (siehe unten) ab.</li><li>Die maximale Rückgabe an Gebäuden ist auf 2000 Gebäude begrenzt.<br>Bitte beachten Sie dies, wenn der Parameter zur Ausdehnung eingegeben wird.</li></ul><h5 id="qualität-der-daten"><a name="qualität-der-daten" href="#qualität-der-daten"></a>Qualität der Daten</h5><p>Die vorgehaltenen Daten auf dem VCS-Server werden abhängig von der jeweiligen Gesetzgebung des jeweiligen Bundeslandes bereitgestellt.</p><p>Die Daten unterscheiden sich folgendermaßen (Stand: 01/2020):</p><ul>
<li>freie Stadtmodelle in LOD2/LOD1, Rückgabe enthält meist LOD2-Daten, Bsp.: Berlin, Hamburg, Thüringen, NRW</li><li>freie Stadtmodelle, Beschränkung auf LOD1, Bsp. Sachsen</li><li>keine kostenlosen Stadtmodelldaten, z.B. Bayern, Brandenburg<br>Hier werden freie Daten von OpenStreetMap verwendet.<br>Dabei wird der in OSM gespeicherte Grundriss um jeweils 3 m pro Geschoss nach oben extrudiert.</li></ul><p>Der Typ der Daten kann anhand der als Revit-Parameter gespeicherten <em>bldg: Building_ID</em> identifiziert werden:</p><ul>
<li>Sind eingefärbte Dachflächen enthalten? -&gt; amtliche LOD2-Daten</li><li>Enthält die Building_ID <em>OSM</em>? -&gt; kostenlose (meist ungenauere) OpenStreetMap-Daten</li><li>Treffen beide Angaben nicht zu? -&gt; amtliche LOD1-Daten </li></ul><p>Einen Überblick über 3D-Stadtmodelldaten, welche vom Server bereitgestellt werden, ist möglich durch Nutzung des <strong><a href="https://deutschland.virtualcitymap.de/#/">Deutschland-Viewers (Link)</a></strong> von virtualcitysystems. Durch Navigation in der Kartenanwendung in der 3D-Ansicht können Gebäude selektiert und deren Informationen angezeigt werden.</p><p>Beispiel aus dem Deutschland-Viewer:</p><ul>
<li>Stadtgrenze Berlin - Potsdam (Brandenburg)</li><li>Selektion rot: amtliche LOD2-Daten aus Berlin mit Dachform und amtlicher ID</li><li>Selektion blau: LOD1-Daten mit OSM-Quelle aus Brandenburg (Höhe grob geschätzt, Lagegenauigkeit ungewiss)</li></ul><p><img src="pic/city2bim_vcsviewer.png" alt="Deutschland_Viewer"></p><p>Sollten genauere Daten in LOD2 benötigt werden, muss in den meisten Fällen das jeweilige zuständige Landesamt kontaktiert werden. Diese stellen Stadtmodell-Daten dateibasiert gegen Entgelt zur Verfügung.</p><h4 id="datei-import-(file-settings)"><a name="datei-import-(file-settings)" href="#datei-import-(file-settings)"></a>Datei-Import (File settings)</h4><p>Liegen dem Nutzer CityGml-Daten lokal vor, z.B. aus Bestellung bei einem zuständigen Landesamt, können diese Daten auch direkt von der Festplatte importiert werden.<br>Dazu muss der Pfad zur Datei im <em>File</em>-Textfeld angegeben werden.</p><p>Zumeist liegen die (amtlichen) Daten in der Koordinatenreihenfolge <em>YXZ</em> vor. Sollte dies einmal nicht der Fall sein, kann die Reihenfolge auch auf <em>XYZ</em> geändert werden.</p><p><strong>Achtung:</strong><br>Der Datei-Import verzichtet auf eine Filterung der Daten bezüglich Projetmittelpunkt oder Ausdehnung.<br>Es ist daher empfehlenswert, keine zu großen CityGML-Daten (bspw. ganze Städte) zu importieren. Der Import würde in diesem Fall sehr lange dauern oder eventuell gar scheitern.</p><h4 id="code-übersetzungen-(codelist-translation)"><a name="code-übersetzungen-(codelist-translation)" href="#code-übersetzungen-(codelist-translation)"></a>Code-Übersetzungen (Codelist-Translation)</h4><p>Amtliche Geodaten für 3D-Stadtmodelle in Deutschland enthalten als Attributwerte oft Zahlen, welche eine Codierung von lesbaren Eigenschaften darstellen. Beispielattribute hierfür sind die Gebäudefunktion oder die Dachform.<br>Das Plugin bietet die Möglichkeit diese Codierungen zu übersetzen.  Dafür sollte der entsprechende Haken gesetzt und die jeweilige Codeliste (AdV oder SIG3D) ausgewählt werden. Die amtlichen deutschen Daten orientieren sich zumeist an der Codierung der AdV.</p><h3 id="import-der-daten-(import-citymodel...)"><a name="import-der-daten-(import-citymodel...)" href="#import-der-daten-(import-citymodel...)"></a>Import der Daten (Import CityModel…)</h3><p>Wurden alle nötigen Einstellungen gesetzt, kann der Import der Daten erfolgen.<br>Dazu ist eine Auswahl des Geometrietyps erforderlich:</p><table>
<thead>
<tr>
<th>LOD2-Gebäude</th>
<th>als Flächenmodelle (Surfaces)</th>
<th>als Voluemenkörper (Solid)</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="pic/city2bim_unselek.png" alt="LOD2-Gebäude"></td>
<td><img src="pic/city2bim_surf_selek.png" alt="LOD2-Surfaces"></td>
<td><img src="pic/city2bim_sel_solid.png" alt="LOD2-Solid"></td>
</tr>
</tbody>
</table><p>Unabhängig von der Auswahl werden folgende Operationen immer durchgeführt:</p><ul>
<li>Prüfung der Eingabegeometrie<br>— Beseitigung doppelter Punkte<br>— Beseitigung von Liniensegmenten, die keine Fläche bilden (“totes Ende”)<br>— keine Berücksichtigung von Polygonen, die weniger als 3 Punkte haben und die nicht denselben Anfangs- und Endpunkt haben (Polygon-Bedingung)</li><li>Berücksichtigung der gespeicherten Attribute und deren Werte (Semantik)<br>— alle Gebäudeattribute, welche im Standard definiert sind<br>— alle generischen Attribute, die vom Urheber der Daten hinzugefügt worden sind (Präfix: <em>gen:</em>)<br>— Adressdaten</li></ul><h4 id="import-als-flächenmodell-(...as-surfaces)"><a name="import-als-flächenmodell-(...as-surfaces)" href="#import-als-flächenmodell-(...as-surfaces)"></a>Import als Flächenmodell (…as Surfaces)</h4><p>Hiebei werden alle Flächen aus den CityGML-Daten mit deren Geometrie direkt importiert.</p><p>Die Flächenmodelle haben folgende exklusive Eigenschaften:</p><ul>
<li>Geometrie: minimaler Extrusionskörper (Tiefe = 1 cm)</li><li>Kategorisierung: entsprechend Typ der CityGML-Fläche: Dach, Wand, Fundament, Allgemeines Modell (wenn nicht näher spezifiziert oder CityGML-ClosureSurface)</li><li>zusätzliche Flächenattrbute, wenn im Datensatz vorhanden (z.B. Dachneigung oder Flächengröße)</li></ul><p>Vorteile:</p><ul>
<li>evtl. zusätzliche Attribute</li><li>spezifische Kategorisierung</li><li>Flächen einzelen selektierbar bzw. manipulierbar</li><li>bei LOD2: Import in der Regel zuverlässiger (Erfolgsquote &gt; 98%)</li></ul><p>Nachteile:</p><ul>
<li>Flächen sind geometrisch nicht miteinander verbunden (nur scheinbar)</li><li>nicht “wasserdicht” (kein Volumenkörper)</li><li>Import dauert wesentlich länger, da mehr Geometrie übertragen werden muss (jede Fläche einzeln)</li><li>Performance des Revit-Projektes wird höher beansprucht</li></ul><h4 id="import-als-volumenkörper-(...as-solid)"><a name="import-als-volumenkörper-(...as-solid)" href="#import-als-volumenkörper-(...as-solid)"></a>Import als Volumenkörper (…as Solid)</h4><p>Hiebei werden alle Flächen aus den CityGML-Daten mit deren Geometrie direkt importiert.</p><p>Die Volumenkörper haben folgende exklusive Eigenschaften:</p><ul>
<li>Geometrie: topologisch verbundener Volumenkörper</li><li>Kategorisierung: Umgebung</li><li>Überführung alle CityGML-Buildings und CityGML-BuindingParts als einzelnen Körper</li></ul><p>Vorteile:</p><ul>
<li>geringere Importdauer</li><li>bessere Performance im Projekt</li><li>Flächen sind miteinander verbunden (keine redundante Geometrie)</li><li>“wasserdicht”</li></ul><p>Nachteile:</p><ul>
<li>evtl. fehlenden Flächenattribute</li><li>bei LOD2: Erfolgsquote in der Regel schlechter (&gt; 90 %)<br>Dies hängt allerdings maßgeblich von der Qualität der Daten ab.</li></ul><p>Berechnung der Volumenkörper:</p><ul>
<li>Überführung der einzelnen Punktkoordinaten der Flächen in topoogische Vertices<br>Dies bedeutet, dass Punkte nicht mehr redundant gepeichert werden müssen und später ein geschlossener Körper generiert werden kann.</li><li>(Neu-)berechnung der Vertices über Ebenenschnittpunktverfahren (Schnitt von 3 Ebenen)</li><li>bei mehr als 3 Ebenen an Eckpunkt, wird versucht, eine möglichst originalgetreue Schnittberechnung durchzuführen<br>In seltenen Fällen kann die Berechnung und Übertragung nach Revit zu groben Ausreißern führen.</li><li>schlägt die Berechnung fehl, sind sogenannte “Fallbacks” implementiert worden (siehe Parameter <strong><em>Kommentare</em></strong>)<br>— ursprüngliche LOD2-Gebäude werden als LOD1 dargestellt (Extrusion des Grundrisses um Gebäudehöhe)<br>— scheitert auch dies aufgrund eines fehlerhaften Grundrisses, wird aus den Grundrisskoordinaten eine konvexe Hülle berechnet, welche dann wiederum um die Gebäudehöhe extrudiert wird</li></ul><h2 id="import-von-alkis-daten-(alkis2bim)"><a name="import-von-alkis-daten-(alkis2bim)" href="#import-von-alkis-daten-(alkis2bim)"></a>Import von ALKIS-Daten (ALKIS2BIM)</h2><p><img src="pic/alkis2bim.png" alt="ALKIS-Icons"></p><p>Die ALKIS2BIM-Funktion bietet die Möglichkeit, amtliche Daten nach dem deutschen ALKIS-Schema zu importieren.<br>Berücksichtigt werden:</p><ul>
<li>Flurstücke mit Attributen und Eigntümer (wenn in Datei enthalten)</li><li>Nutzungsarten ohne Attribute, aber entsprechend Thema eingefärbt</li><li>Gebäudeumringe</li></ul><p>Es handelt sich jeweils um 2D-Flächen, welche in einer separaten Ebene unterhalb der Projekthöhe positioniert werden. Wurde vorher mittels DTM2BIM ein Gelände erstellt, ist es außerdem möglich einen oder mehrere ALKIS-Themen auf dem Gelände auotmatisiert drapieren zu lassen.</p><h3 id="settings"><a name="settings" href="#settings"></a>Settings</h3><p><img src="pic/alkis2bim_settings.png" alt="ALKIS-Settings"></p><h4 id="datei-import-(file-settings)"><a name="datei-import-(file-settings)" href="#datei-import-(file-settings)"></a>Datei-Import (File Settings)</h4><p>Vor dem Import muss im Settings-Fenster der Pfad zu den ALKIS-Daten gesetzt werden. Vom Programm berücksichtigt werden ausschließlich Daten im XML-Format aus der NAS-Schnittstelle (NAS-XML).</p><p>Sollten Daten nicht in der Koordinatenreihenfolge <em>YXZ</em> vorliegen, kann dies hier auf <em>XYZ</em> geändert werden.</p><ul>
<li>Import der ALKIS-Themen: Gebäudeumringe, Nutzungsarten, Flurstücke (Reihenfolge von oben nach unten)</li><li>Einfärbung der Nutzungsarten nach ALKIS-Objektartengruppen: Verkehr, Vegetation, Siedlung, Gewässer</li><li>Identifizierung der Objektart der Nutzungsart (z.B. Straße, Gehölz) über Parameter <em>Kommentare</em></li><li>Berücksichtigung von Flurstücksdaten als Parameter</li><li>Erstellung von 2D-Plänen für jede ALKIS-Ebene in den Grundrissen</li><li>Kategorisierung als Unterregionen innerhalb einer Topographie-Fläche (diese dient als Referenzfläche)</li></ul><p>Beispiel:</p><p><img src="pic/alkis2bim_data.png" alt="ALKIS-Ebenen"></p><h4 id="texturierung-auf-geländeoberfläche-(drape-on-terrain)"><a name="texturierung-auf-geländeoberfläche-(drape-on-terrain)" href="#texturierung-auf-geländeoberfläche-(drape-on-terrain)"></a>Texturierung auf Geländeoberfläche (Drape on Terrain)</h4><p>Diese Funktion bietet dem Nutzer die Möglichkeit, ein oder mehrere ALKIS-Themen direkt auf das Gelände zu legen. Dies ist vor allem für visuelle Präsentationszwecke geeignet. (Bildbespiel, siehe Bild in Überblick)</p><p><strong>Achtung:</strong></p><ul>
<li>die Funktion ist (derzeit) nur aktiviert, wenn vorher über DTM2BIM ein Gelände erstellt wurde</li><li>es ist nicht empfehlenswert, Flurstücke (<em>drape Parcels</em>) und Nutzungsarten (<em>drape Usage</em>) zusammen zu nutzen, da sich die Flächen in der Regel gegenseitig überlagern</li></ul><h2 id="import-von-raster-geländemodellen-(dtm2bim)"><a name="import-von-raster-geländemodellen-(dtm2bim)" href="#import-von-raster-geländemodellen-(dtm2bim)"></a>Import von Raster-Geländemodellen (DTM2BIM)</h2><p><img src="pic/dtm2bim.png" alt="DTM2BIM-Icon"></p><p>Das Plugin ermöglicht den Import von Digitalen Geländemodellen, welche als Raster vorliegen.<br>Solche Raster-DGM sind zumeist bei den jeweiligen Landesämtern in unterschiedlichen Gitterweiten verfügbar.</p><ul>
<li>Import im <em>txt</em>- oder <em>csv</em>-Format</li><li>je kleiner die Gitterweite, desto höher die Genauigkeit, aber desto länger dauert der Import</li><li>daher sollte aus Performance-Gründen kein zu großes Gebiet importiert werden</li><li>Achtung: Raster-DGM enthalten keine Bruchkanten!</li><li>Kategorisierung: Topographie</li><li>Ein- und Ausblenden von Höhenlinien und/oder Triangulationskanten mit Revit-Mitteln möglich</li></ul><p>Beispiel (mit Stadtmodell-Gebäuden):</p><p><img src="pic/dtm2bim_data.png" alt="DGM-Bsp"></p><h2 id="ifc-export"><a name="ifc-export" href="#ifc-export"></a>IFC-Export</h2><p><img src="pic/ifc_export.png" alt="IFC-Export-Icon"></p><p>Derzeit wurde (noch) kein eigener IFC-Exporter implementiert. Bitte nutzen Sie zum Export den revit-eigenen Exporter.<br>Es wird lediglich im lokalen Verzeichnis <em>C:\Users\[username]\AppData\Local\City2BIM</em> eine Datei angelegt, mit welcher die Georeferenzierung standardkonfrom als PropertySet übergeben werden kann.</p><p><strong>Aufbau Datei:</strong></p><p><img src="pic/ifc_export_paramset.png" alt="Revit IFC-Exporter"></p><p>Die Attribute zur Georeferenzierung aus den Projektinformationen werden beim IFC-Export dadurch in die PropertySets <em>ePset_MapConversion</em> bzw. <em>ePset_ProjectedCRS</em> geschrieben.<br>Um dies zu gewährleisten muss beim Export diese Textdatei eingebunden werden, siehe Bild (Revit Ifc Exporter-Einstellungen):</p><p><img src="pic/ifc_export_exporterGUI.png" alt="IFC-Exporter"></p><h2 id="overview"><a name="overview" href="#overview"></a>Overview</h2><p>PlugIn for Autodesk Revit for integration of 3D-CityModels from CityGml, 2D-Surfaces from ALKIS (german standard for parcels, usage, building contours) and terrain grid data in a common global or local coordinate systems (e.g. ETRS89_UTM32). </p><p><img src="pic/3d_overview.png" alt="Overview"></p><h2 id="installation_eng"><a name="installation_eng" href="#installation_eng"></a>Installation_eng</h2><p>After the download please start the setup.exe. The plugin should be installed automatically.</p><p>By the next start of Autodesk Revit 2019 there should be the plugin available in the ribbon bar. If you will be asked whether plugin should be imported please click <em>Always load</em>.</p><p>If there is no plugin available your Revit installation is maybe not in the assumed folder:<br><em>[CommonAppDataFolder]\Autodesk\Revit\Addins\2019</em>.<br>CommonAppDataFolder is in the most cases <em>C:\ProgramData</em>.</p><p>If so please navigate manually to the Addins folder of your installation and copy the addin-file <em>City2BIM.addin</em> and the folder <em>City2RVT</em> into the subfolder of version <em>2019</em>.</p><h3 id="built-with"><a name="built-with" href="#built-with"></a>Built With</h3><ul>
<li>.NET Framework and Visual Studio 2019</li></ul><h3 id="dependencies"><a name="dependencies" href="#dependencies"></a>Dependencies</h3><ul>
<li><a href="https://github.com/dd-bim/City2BIM">City2BIM</a> for reading CityGml and ALIKS data</li><li><a href="https://www.nayuki.io/page/convex-hull-algorithm">Project Nayuki</a> for Convex Hull calculation</li><li><a href="https://geographiclib.sourceforge.io/">GeograpicLib</a> for conversion between WGS84-LatLon and UTM, scale and grid north calculation</li><li><a href="https://serilog.net/">Serilog</a> for Logging messages</li><li><a href="https://www.revitapidocs.com/">Revit API</a> for import to Autodesk Revit (proprietary, not included in Download)</li></ul><h2 id="plugin-user-interface"><a name="plugin-user-interface" href="#plugin-user-interface"></a>Plugin User Interface</h2><p>Functionality of the plugin is available under the ribbon tab <em>City2BIM</em>.</p><p><img src="pic/ribbon_entry.png" alt="Ribbon tab"></p><p>If this tab is not available please check for the location of the needed .addin file and also the path to the relevant dll in the addin-file (see <a href="#installation_eng">Installation(eng)</a>).</p><p>The ribbon tab includes the following icons:</p><p><img src="pic/ribbon.png" alt="Ribbon tab content"></p><h2 id="recommended-workflow"><a name="recommended-workflow" href="#recommended-workflow"></a>Recommended workflow</h2><p>Preparation:</p><ul>
<li>Acquisition of relevant geodata<br>— City Model data as CityGML-file (or use server reponse [only for Germany])<br>— ALKIS data as NAS-XML (only in Germany available, German standard for the exchange of land register data)<br>— Terrain data as Grid-DTM (Digital Terrain Model)</li><li>Definition of the project base point coordinate:<br>— at best in metric national system coordinates<br>— alternatively: WGS84 coordinates in Latitude/Longitude (only if geodetic system is ETRS89_UTM system)</li></ul><p>Program workflow</p><ul>
<li>First of all, it is important to <strong>determine the georeferencing</strong> by input of the project base point coordinate in position and height</li><li>then relevant geodata can be imported<br>— Attention: it must be ensured that all geodata are available in the same reference system</li><li>if one or more ALKIS themes are to be draped on the terrain, the terrain must be imported <strong>before</strong> the ALKIS import</li></ul><h2 id="contributors"><a name="contributors" href="#contributors"></a>Contributors</h2><p>The concept together with the tool was developed within the scope of the following sponsorship project:</p><p><strong>3D-Punktwolke - CityBIM </strong></p><table>
<thead>
<tr>
<th>in association with</th>
<th>supported by</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.virtualcitysystems.de/"><img src="pic/vcs.png" alt="virtualcitySystems"></a></td>
<td><img src="pic/BMWi_4C_Gef_en.jpg" align="center" style="width: 200px;"></td>
</tr>
</tbody>
</table><h2 id="contact"><a name="contact" href="#contact"></a>Contact</h2><p> <img src="pic/logo_htwdd.jpg" align="center" style="width: 300px;">  </p><p><strong>HTW Dresden</strong><br><strong>Fakultät Geoinformation</strong><br>Friedrich-List-Platz 1<br>01069 Dresden</p><p>Project head:</p><ul>
<li>Prof. Dr.-Ing. Christian Clemen (<a href="mailto:christian.clemen@htw-dresden.de">christian.clemen@htw-dresden.de</a>)</li></ul><p>Project staff:</p><ul>
<li>Hendrik Görne, M.Eng.</li><li>Tim Kaiser, M.Eng.</li><li>Sören Meier, M.Eng.</li><li>Enrico Romanschek, M.Eng.</li></ul><h2 id="license"><a name="license" href="#license"></a>License</h2><p>This project is licensed under the MIT License:</p><pre><code data-origin="<pre><code>Copyright (c) 2020 HTW Dresden

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &quot;Software&quot;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
</code></pre>">Copyright (c) 2020 HTW Dresden

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
</code></pre>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
